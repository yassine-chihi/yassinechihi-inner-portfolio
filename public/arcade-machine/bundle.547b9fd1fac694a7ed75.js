(()=>{"use strict";const t=class{constructor(){this.canvas=document.getElementById("game"),this.currentScoreElement=document.getElementById("currentScore"),this.maxScoreElement=document.getElementById("maxScore"),this.currentScoreElement.style.display="block",this.maxScoreElement.style.display="block",this.currentScore=0,this.updateScore(),this.canvas.style.display="block",this.context=this.canvas.getContext("2d"),this.keyDownAllowed=!0,this.keysPressedQueue=[],this.grid=32,this.numCellsW=this.canvas.width/this.grid,this.numCellsH=this.canvas.height/this.grid,this.snake={x:160,y:160,dx:this.grid,dy:0,cells:[],maxCells:4},this.apple={x:320,y:320},this.loopInterval=50,this.loopId=null}getRandomInt(t,e){return Math.floor(Math.random()*(e-t))+t}loop=()=>{this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.snake.x+=this.snake.dx,this.snake.y+=this.snake.dy,this.snake.x<0?this.snake.x=this.canvas.width-this.grid:this.snake.x>=this.canvas.width&&(this.snake.x=0),this.snake.y<0?this.snake.y=this.canvas.height-this.grid:this.snake.y>=this.canvas.height&&(this.snake.y=0),this.snake.cells.unshift({x:this.snake.x,y:this.snake.y}),this.snake.cells.length>this.snake.maxCells&&this.snake.cells.pop(),this.context.fillStyle="#ff0000",this.context.beginPath(),this.context.arc(this.apple.x+this.grid/2,this.apple.y+this.grid/2,12,0,2*Math.PI),this.context.fill(),this.context.fillStyle="#35de00",this.snake.cells.forEach(((t,e)=>{this.context.fillRect(t.x,t.y,this.grid-1,this.grid-1),t.x===this.apple.x&&t.y===this.apple.y&&(window.parent.postMessage("hit","*"),this.snake.maxCells++,this.apple.x=this.getRandomInt(0,this.numCellsW)*this.grid,this.apple.y=this.getRandomInt(0,this.numCellsH)*this.grid,this.currentScore+=10,this.updateScore());for(let s=e+1;s<this.snake.cells.length;s++)t.x===this.snake.cells[s].x&&t.y===this.snake.cells[s].y&&(window.parent.postMessage("die","*"),this.currentScore=0,this.updateScore(),this.snake.x=160,this.snake.y=160,this.snake.cells=[],this.snake.maxCells=4,this.snake.dx=this.grid,this.snake.dy=0,this.apple.x=this.getRandomInt(0,this.numCellsW)*this.grid,this.apple.y=this.getRandomInt(0,this.numCellsH)*this.grid)}))};listenKeyboard(){window.addEventListener("message",this.handleParentMessage),window.addEventListener("keydown",this.keyListener)}handleParentMessage=t=>{"keyDownParent"===t.data.type&&this.keyListener(t.data)};keyListener=t=>{this.keyDownAllowed?(this.processKeyEvent(t),this.keyDownAllowed=!1,setTimeout((()=>{for(this.keyDownAllowed=!0;this.keysPressedQueue.length>0;){const t=this.keysPressedQueue.shift();this.processKeyEvent(t)}}),this.loopInterval)):this.keysPressedQueue.push(t)};updateScore(){let t=localStorage.getItem("maxSnakeScore")||0;this.currentScore>t&&(t=this.currentScore,localStorage.setItem("maxSnakeScore",this.currentScore)),this.currentScoreElement.textContent="CURRENT SCORE: "+this.currentScore,this.maxScoreElement.textContent="MAX SCORE: "+t}processKeyEvent(t){"ArrowLeft"===t.key&&0===this.snake.dx?(this.snake.dx=-this.grid,this.snake.dy=0):"ArrowUp"===t.key&&0===this.snake.dy?(this.snake.dy=-this.grid,this.snake.dx=0):"ArrowRight"===t.key&&0===this.snake.dx?(this.snake.dx=this.grid,this.snake.dy=0):"ArrowDown"===t.key&&0===this.snake.dy&&(this.snake.dy=this.grid,this.snake.dx=0)}start(){this.listenKeyboard(),this.loopId=setInterval(this.loop,this.loopInterval)}destroy(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),clearInterval(this.loopId),window.removeEventListener("message",this.handleParentMessage),this.canvas.style.display="none"}},e=class{constructor(){this.canvas=document.getElementById("tetris"),this.currentScoreElement=document.getElementById("currentScore"),this.maxScoreElement=document.getElementById("maxScore"),this.currentScoreElement.style.display="block",this.maxScoreElement.style.display="block",this.canvas.style.display="block",this.context=this.canvas.getContext("2d"),this.loopInterval=5,this.loopId=null,this.grid=32,this.currentScore=0,this.updateScore(),this.tetrominoSequence=[],this.playfield=[],this.clearPlayfield(),this.tetrominos={I:[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],J:[[1,0,0],[1,1,1],[0,0,0]],L:[[0,0,1],[1,1,1],[0,0,0]],O:[[1,1],[1,1]],S:[[0,1,1],[1,1,0],[0,0,0]],Z:[[1,1,0],[0,1,1],[0,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]]},this.colors={I:"#00ffff",O:"#ffff00",T:"#800080",S:"#00ff00",Z:"#ff0000",J:"#0000ff",L:"#ff7f00"},this.count=0,this.gameOver=!1,this.clearPlayfield(),this.tetromino=this.getNextTetromino()}updateScore(){let t=localStorage.getItem("maxTetrisScore")||0;this.currentScore>t&&(t=this.currentScore,localStorage.setItem("maxTetrisScore",this.currentScore)),this.currentScoreElement.textContent="CURRENT SCORE: "+this.currentScore,this.maxScoreElement.textContent="MAX SCORE: "+t}start(){window.addEventListener("message",this.handleParentMessage),window.addEventListener("keydown",this.keyDownHandler),this.loopId=setInterval(this.loop,this.loopInterval)}loop=()=>{this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(let t=0;t<20;t++)for(let e=0;e<10;e++)if(this.playfield[t][e]){const s=this.playfield[t][e];this.context.fillStyle=this.colors[s],this.context.fillRect(e*this.grid,t*this.grid,this.grid-1,this.grid-1)}if(this.tetromino){++this.count>35&&(this.tetromino.row++,this.count=0,this.isValidMove(this.tetromino.matrix,this.tetromino.row,this.tetromino.col)||(this.tetromino.row--,this.placeTetromino())),this.context.fillStyle=this.colors[this.tetromino.name];for(let t=0;t<this.tetromino.matrix.length;t++)for(let e=0;e<this.tetromino.matrix[t].length;e++)this.tetromino.matrix[t][e]&&this.context.fillRect((this.tetromino.col+e)*this.grid,(this.tetromino.row+t)*this.grid,this.grid-1,this.grid-1)}};generateSequence(){const t=["I","J","L","O","S","T","Z"];for(;t.length;){const e=this.getRandomInt(0,t.length-1),s=t.splice(e,1)[0];this.tetrominoSequence.push(s)}}getNextTetromino(){0===this.tetrominoSequence.length&&this.generateSequence();const t=this.tetrominoSequence.pop(),e=this.tetrominos[t];return{name:t,matrix:e,row:"I"===t?-1:-2,col:this.playfield[0].length/2-Math.ceil(e[0].length/2)}}rotate(t){const e=t.length-1;return t.map(((s,i)=>s.map(((s,h)=>t[e-h][i]))))}isValidMove(t,e,s){for(let i=0;i<t.length;i++)for(let h=0;h<t[i].length;h++)if(t[i][h]&&(s+h<0||s+h>=this.playfield[0].length||e+i>=this.playfield.length||this.playfield[e+i][s+h]))return!1;return!0}placeTetromino(){for(let t=0;t<this.tetromino.matrix.length;t++)for(let e=0;e<this.tetromino.matrix[t].length;e++)if(this.tetromino.matrix[t][e]){if(this.tetromino.row+t<0)return window.parent.postMessage("die","*"),void this.showGameOver();this.playfield[this.tetromino.row+t][this.tetromino.col+e]=this.tetromino.name}let t=0;for(let e=this.playfield.length-1;e>=0;)if(this.playfield[e].every((t=>!!t))){++t;for(let t=e;t>=0;t--)for(let e=0;e<this.playfield[t].length;e++)this.playfield[t][e]=this.playfield[t-1][e]}else e--;t>0?window.parent.postMessage("tetris","*"):window.parent.postMessage("select1","*"),0==t?this.currentScore+=10:1==t?this.currentScore+=100:2==t?this.currentScore+=300:3==t?this.currentScore+=500:4==t&&(this.currentScore+=800),this.updateScore(),this.tetromino=this.getNextTetromino()}showGameOver(){this.gameOver=!0,this.currentScore=0,this.updateScore(),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.clearPlayfield()}clearPlayfield(){for(let t=-2;t<20;t++){this.playfield[t]=[];for(let e=0;e<10;e++)this.playfield[t][e]=0}}destroy(){this.showGameOver(),clearInterval(this.loopId),window.removeEventListener("message",this.handleParentMessage),window.removeEventListener("keydown",this.keyDownHandler),this.canvas.style.display="none"}getRandomInt(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}handleParentMessage=t=>{"keyDownParent"===t.data.type&&this.keyDownHandler(t.data)};keyDownHandler=t=>{if("ArrowLeft"===t.key||"ArrowRight"===t.key){const e="ArrowLeft"===t.key?this.tetromino.col-1:this.tetromino.col+1;this.isValidMove(this.tetromino.matrix,this.tetromino.row,e)&&(this.tetromino.col=e)}if("ArrowUp"===t.key){const t=this.rotate(this.tetromino.matrix);this.isValidMove(t,this.tetromino.row,this.tetromino.col)&&(this.tetromino.matrix=t)}if("ArrowDown"===t.key){const t=this.tetromino.row+1;if(!this.isValidMove(this.tetromino.matrix,t,this.tetromino.col))return this.tetromino.row=t-1,void this.placeTetromino();this.tetromino.row=t}}},s=class{constructor(){this.canvas=document.getElementById("break-out"),this.context=this.canvas.getContext("2d"),this.currentScoreElement=document.getElementById("currentScore"),this.maxScoreElement=document.getElementById("maxScore"),this.currentScoreElement.style.display="block",this.maxScoreElement.style.display="block",this.canvas.style.display="block",this.currentScore=0,this.loopInterval=1,this.loopId=null,this.brickGap=2,this.brickWidth=48,this.brickHeight=24,this.limitScore=448,this.bricks=[],this.paddle={x:this.canvas.width/2-this.brickWidth/2,y:600,width:this.brickWidth,height:this.brickHeight,dx:0},this.ball={x:50,y:300,width:16,height:16,speed:2,dx:0,dy:0},this.colorMap={R:"#a40600",O:"#c88000",G:"#007f23",Y:"#c7c519"},this.isKeyLeftPressing=!1,this.isKeyRightPressing=!1,this.level=[[],[],[],["R","R","R","R","R","R","R","R","R","R","R","R","R","R"],["R","R","R","R","R","R","R","R","R","R","R","R","R","R"],["O","O","O","O","O","O","O","O","O","O","O","O","O","O"],["O","O","O","O","O","O","O","O","O","O","O","O","O","O"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y"],["Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y"]],this.updateScore()}createLevel(t){for(let e=0;e<t.length;e++)for(let s=0;s<t[e].length;s++){const i=t[e][s];this.bricks.push({x:(this.brickWidth+this.brickGap)*s,y:(this.brickHeight+this.brickGap)*e,color:this.colorMap[i],colorCode:i,width:this.brickWidth,height:this.brickHeight})}}collides(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}loop=()=>{this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.paddle.x+=this.paddle.dx,this.paddle.x<0?this.paddle.x=0:this.paddle.x+this.brickWidth>this.canvas.width&&(this.paddle.x=this.canvas.width-this.brickWidth),this.ball.x+=this.ball.dx,this.ball.y+=this.ball.dy,this.ball.x<0?(window.parent.postMessage("hit","*"),this.ball.x=0,this.ball.dx*=-1):this.ball.x+this.ball.width>this.canvas.width&&(window.parent.postMessage("hit","*"),this.ball.x=this.canvas.width-this.ball.width,this.ball.dx*=-1),this.ball.y<0&&(this.ball.y=0,this.ball.dy*=-1),this.ball.y>this.canvas.height&&(this.ball.x=50,this.ball.y=300,this.ball.dx=0,this.ball.dy=0,window.parent.postMessage("die","*"),this.resetLevel()),this.checkBallPaddleCollision();for(let t=0;t<this.bricks.length;t++){const e=this.bricks[t];if(this.collides(this.ball,e)){switch(window.parent.postMessage("hit","*"),e.colorCode){case"Y":this.currentScore+=1;break;case"G":this.currentScore+=3;break;case"O":this.currentScore+=5;break;case"R":this.currentScore+=7}this.updateScore(),this.bricks.splice(t,1),this.ball.y+this.ball.height-this.ball.speed<=e.y||this.ball.y>=e.y+e.height-this.ball.speed?this.ball.dy*=-1:this.ball.dx*=-1;break}}(this.ball.dx||this.ball.dy)&&(this.context.fillStyle="#a9a8a9",this.context.fillRect(this.ball.x,this.ball.y,this.ball.width,this.ball.height)),this.bricks.forEach((t=>{this.context.fillStyle=t.color,this.context.fillRect(t.x,t.y,t.width,t.height)})),this.context.fillStyle="#005b91",this.context.fillRect(this.paddle.x,this.paddle.y,this.paddle.width,this.paddle.height)};keyDownHandler=t=>{"ArrowLeft"===t.key?(this.isKeyLeftPressing=!0,this.paddle.dx=-3):"ArrowRight"===t.key&&(this.isKeyRightPressing=!0,this.paddle.dx=3)};keyUpHandler=t=>{"ArrowLeft"===t.key?(this.isKeyLeftPressing=!1,this.isKeyRightPressing||(this.paddle.dx=0)):"ArrowRight"===t.key&&(this.isKeyRightPressing=!1,this.isKeyLeftPressing||(this.paddle.dx=0))};checkBallPaddleCollision(){const t={x:this.paddle.x+this.paddle.width/2-24,y:this.paddle.y,width:8,height:32},e={x:this.paddle.x+this.paddle.width/2+24,y:this.paddle.y,width:8,height:32},s={x:this.paddle.x+this.paddle.width/2-12,y:this.paddle.y,width:8,height:32},i={x:this.paddle.x+this.paddle.width/2+12,y:this.paddle.y,width:8,height:32},h={x:this.paddle.x+this.paddle.width/2,y:this.paddle.y,width:16,height:32};this.collides(this.ball,h)?(window.parent.postMessage("hit","*"),this.ball.dx=this.ball.dx<0?-1:1,this.ball.dy=this.ball.dy<0?2:-2,this.ball.y=this.paddle.y-this.ball.height):this.collides(this.ball,i)||this.collides(this.ball,s)?(window.parent.postMessage("hit","*"),this.ball.dx=this.ball.dx<0?-2:2,this.ball.dy=this.ball.dy<0?2:-2,this.ball.y=this.paddle.y-this.ball.height):(this.collides(this.ball,e)||this.collides(this.ball,t))&&(window.parent.postMessage("hit","*"),this.ball.dx=this.ball.dx<0?-2:2,this.ball.dy=this.ball.dy<0?1:-1,this.ball.y=this.paddle.y-this.ball.height)}resetLevel(){this.currentScore=0,this.updateScore(),this.bricks=[],this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.createLevel(this.level),this.paddle.x=this.canvas.width/2-this.brickWidth/2,this.paddle.y=600,this.ball.dx=2,this.ball.dy=2}updateScore(){let t=localStorage.getItem("maxBreakOutScore")||0;this.currentScore>t&&(t=this.currentScore,localStorage.setItem("maxBreakOutScore",this.currentScore)),this.currentScoreElement.textContent="CURRENT SCORE: "+this.currentScore,this.maxScoreElement.textContent="MAX SCORE: "+t,this.currentScore>=this.limitScore&&this.resetLevel()}handleParentMessage=t=>{"keyDownParent"===t.data.type?this.keyDownHandler(t.data):"keyUpParent"===t.data.type&&this.keyUpHandler(t.data)};listenKeyboard(){window.addEventListener("message",this.handleParentMessage),window.addEventListener("keydown",this.keyDownHandler),window.addEventListener("keyup",this.keyUpHandler)}destroy(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),clearInterval(this.loopId),window.removeEventListener("message",this.handleParentMessage),window.removeEventListener("keydown",this.keyDownHandler),window.removeEventListener("keyup",this.keyUpHandler),this.canvas.style.display="none"}start(){this.createLevel(this.level),this.ball.dx=2,this.ball.dy=2,this.listenKeyboard(),this.loopId=setInterval(this.loop,this.loopInterval)}},i=document.querySelectorAll(".game-option"),h=document.getElementById("menu"),l=document.getElementById("title"),n=document.getElementById("currentScore"),a=document.getElementById("maxScore");let o=0,r=null;function d(){i.forEach((function(t){t.textContent=t.textContent.replace(/[<>]/g,"")}));const t=i[o];t.textContent="> "+t.textContent+" <"}function c(i){if(null==r){switch(i.key){case"ArrowUp":window.parent.postMessage("select1","*"),o=0===o?2:o-1;break;case"ArrowDown":window.parent.postMessage("select1","*"),o=2===o?0:o+1;break;case" ":case"Enter":window.parent.postMessage("select2","*"),function(){switch(o){case 0:h.style.display="none",l.style.display="none",r=new t,r.start();break;case 1:h.style.display="none",l.style.display="none",r=new e,r.start();break;case 2:h.style.display="none",l.style.display="none",r=new s,r.start()}}()}d()}else"Escape"==i.key&&null!=r&&(window.parent.postMessage("select2","*"),n.style.display="none",a.style.display="none",r.destroy(),r=null,l.style.display="block",h.style.display="block",window.addEventListener("message",y),window.addEventListener("keydown",c))}function y(t){"keyDownParent"===t.data.type&&c(t.data)}d(),window.addEventListener("message",y),window.addEventListener("keydown",c)})();
//# sourceMappingURL=bundle.547b9fd1fac694a7ed75.js.map